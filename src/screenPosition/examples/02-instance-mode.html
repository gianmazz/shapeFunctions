<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>p5.js example</title>
    <style> body {padding: 0; margin: 0;} </style>

    <script src="../lib/p5.js"></script>
    <script src="../addScreenPositionFunction.js"></script>
  </head>
  <body>
    <script type="text/javascript">
      
      let myp5 = new p5(( p ) => {
   
        let mode = "3D";

        p.setup = function() {
          if (mode == "2D") p.createCanvas(p.windowWidth, p.windowHeight);
          else p.createCanvas(p.windowWidth, p.windowHeight, p.WEBGL);

          addScreenPositionFunction(p);

          p.rectMode(p.CENTER);
          p.stroke(255);
        };

        p.draw = function() {
          p.background(0);

          p.push();

          if (mode == "2D") p.translate(p.width / 2, p.height / 2);

          if (mode == "2D") p.rotate(p.radians(p.frameCount));
          else p.rotateY(p.radians(p.frameCount));

          p.shearX(p.sin(p.frameCount / 100));
          p.shearY(p.cos(p.frameCount / 73));

          p.scale(1.2, 1.5, 0.8);

          p.line(-100, -100, 100, 100);

          let p1 = p.screenPosition(-100, -100, 0);
          let p2 = p.screenPosition(100, 100, 0);

          if (mode == "2D") p.rotate(p.radians(90));
          else p.rotateY(p.radians(90));

          p.fill(128);
          p.rect(0, 0, 100, 100);

          p.pop();

          p.fill(255, 0, 0);
          p.circle(p1.x, p1.y, 10);
          p.circle(p2.x, p2.y, 10);
        };

        p.mousePressed = function() {
          p.noLoop();
        }


      });



    </script>
  </body>
</html>
